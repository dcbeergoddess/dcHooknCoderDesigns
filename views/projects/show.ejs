<% layout('layouts/boilerplate') %>
  <div class="row">
    <div class="col-6">
      <div class="card mb-3">
        <% for( let img of project.images ) { %>
          <img src="<%= img.url %>" class="card-img-top" alt="...">
        <% } %>
        <div class="card-body">
          <h5 class="card-title">
            <%= project.title %>
          </h5>
          <!-- Possible add description to project model later -->
          <!-- <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p> -->
        </div>
        <ul class="list-group list-group-flush">
          <li class="list-group-item"><strong>Project Creator:</strong>
            <%= project.author.username %>
          </li>
          <li class="list-group-item"><strong>Pattern Source:</strong>
            <%= project.pattern %>
          </li>
          <li class="list-group-item"><strong>Craft:</strong>
            <%= project.craft %>
          </li>
          <li class="list-group-item"><strong>Yarn Weight:</strong>
            <%= project.yarnCategory %>
          </li>
          <li class="list-group-item"><strong>Project Tool:</strong>
            <%= project.tool %>
          </li>
          <li class="list-group-item"><strong>Project Tool Size:</strong>
            <%= project.toolSize %> mm
          </li>
        </ul>
        <% if (currentUser && project.author.equals(currentUser._id)) { %>
          <div class="card-body">
            <a class="btn btn-info" href="/projects/<%= project.id %>/edit" class="card-link">Edit Project</a>
            <form class="d-inline" action="/projects/<%= project.id %>?_method=DELETE" method="POST">
              <button class="btn btn-danger">Delete</button>
            </form>
          </div>        
          <% } %>
      </div>
    </div>
    <div class="col-6">
      <% if (currentUser) { %>
      <h2>Leave a Comment</h2>
      <form action="/projects/<%=project._id%>/comments" method="POST" class="mb-3 needs-validation" novalidate>
        <div class="mb-3">
          <label class="form-label" for="body">Comment</label>
          <textarea class="form-control" name="comment[body]" id="body" cols="30" rows="5" required></textarea>
          <div class="valid-feedback">
            LOOKS GOOD!
          </div>
        </div>
        <div class="mb-3">
          <button class="btn btn-success">Add Comment</button>
        </div>
      </form>
      <% } %>
      <% for( let comment of project.comments ) { %>
        <div class="card mb-3">
          <div class="card-body">
            <h5 class="card-title">Comment</h5>
            <h6 class="card-subtitle mb-2 text-muted">By <%= project.author.username %> </h6>
            <p class="card-text">
              <%= comment.body %>
            </p>
            <% if (currentUser && project.author.equals(currentUser._id)) { %>
            <form action="/projects/<%=project._id%>/comments/<%=comment._id%>?_method=DELETE" method="POST">
              <button class="btn btn-sm btn-danger">Delete</button>
            </form>
            <% } %>
          </div>
          <footer class="card-footer text-muted">
            2 days ago
            <!-- <a href="/projects">All Projects</a> -->
          </footer>
        </div>
        <% } %>
    </div>
  </div>